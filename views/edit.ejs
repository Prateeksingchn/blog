<% include ./partials/header.ejs %>

<form hidden id="fileform" method="post" enctype="multipart/form-data" action="/upload">
  <input id="file" type="file" name="image" accept="image/*">
</form>

<div class="min-h-screen bg-gradient-to-r from-green-100 to-emerald-100 py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-3xl mx-auto">
    <h1 class="text-4xl text-center text-emerald-800 font-extrabold mb-8">Edit Profile</h1>
    <div class="bg-white shadow-xl rounded-lg overflow-hidden p-6">
      <div class="flex flex-col items-center justify-center mb-8">
        <div class="relative group">
          <div class="w-32 h-32 rounded-full overflow-hidden ring-4 ring-emerald-500 ring-offset-4 ring-offset-emerald-100">
            <img class="w-full h-full object-cover" src="/images/uploads/<%= user.profileImage %>" alt="Profile picture">
          </div>
          <button id="editbtn" class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </button>
        </div>
        <p class="mt-2 text-sm text-gray-600">Click to change profile picture</p>
      </div>
      
      <h3 class="text-lg font-medium text-gray-900 mb-4">Edit Account Details</h3>
      <form action="/update" method="post" class="space-y-4">
        <div>
          <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Username</label>
          <input type="text" id="username" name="username" value="<%= user.username %>" class="shadow-sm focus:ring-emerald-500 focus:border-emerald-500 block w-full sm:text-sm border-gray-300 rounded-md">
        </div>
        <div>
          <label for="fullname" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
          <input type="text" id="fullname" name="fullname" value="<%= user.fullname %>" class="shadow-sm focus:ring-emerald-500 focus:border-emerald-500 block w-full sm:text-sm border-gray-300 rounded-md">
        </div>
        <div>
          <label for="bio" class="block text-sm font-medium text-gray-700 mb-1">Bio</label>
          <textarea id="bio" name="bio" rows="4" class="shadow-sm focus:ring-emerald-500 focus:border-emerald-500 block w-full sm:text-sm border-gray-300 rounded-md"><%= user.bio %></textarea>
        </div>
        <div>
          <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500">
            Update Details
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  document.querySelector("#editbtn").addEventListener("click", function(){
    document.querySelector("#file").click();
  });

  document.querySelector("#file").addEventListener("change", function(){
    document.querySelector("#fileform").submit();
  });
</script>

<% include ./partials/footer.ejs %>